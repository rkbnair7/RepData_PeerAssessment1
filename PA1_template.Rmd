
**Title: Reproducible Research: Peer Assessment 1**

Author: Rad Nair


Date: 11/22/2019


Loading libraries
```{r echo=TRUE}

library(knitr)
library(dplyr)
library(ggplot2)

opts_chunk$set(echo = TRUE)

```

Setting working directory

```{r echo=TRUE}
setwd("C:\\DS\\Week2\\RepData_PeerAssessment1-master")
```


**Code for reading in the dataset and/or processing the data**

```{r echo=TRUE}
dr<- read.csv('activity.csv')

# Eliminating missing values
activity_data <- dr[ with (dr, { !(is.na(steps)) } ), ]
```

**Calculating the mean total number of steps taken per day**

```{r echo=TRUE}
activity_data_by_day <- group_by(activity_data, date)

stepsByDay <- summarise(activity_data_by_day, total = sum(steps))

stepsByDay

```

**Histogram of the total number of steps taken each day**

```{r echo=TRUE}
hist(stepsByDay$total, main="Total steps per day", 
     xlab="Total steps in a day",col="green")
```



```{r echo=TRUE}
summary(stepsByDay)
```

**Calculating the average daily activity pattern**
```{r echo=TRUE}
stepsByInterval <- aggregate(steps ~ interval, activity_data, mean)

plot(stepsByInterval$interval, stepsByInterval$steps, type='l', 
     main="Avg steps - all days", xlab="Interval", 
     ylab="Avg steps")
```    

```{r echo=TRUE}

Maximum_steps_no <- which.max(stepsByInterval$steps)

stepsByInterval[Maximum_steps_no, ]

```

**Imputing missing values**
```{r echo=TRUE}

sum(is.na(dr))

da_imputed <- dr
for (i in 1:nrow(da_imputed)) {
  if (is.na(da_imputed$steps[i])) {
    interval <- da_imputed$interval[i]
    steps <- stepsByInterval[
      stepsByInterval$interval == interval,]
    da_imputed$steps[i] <- steps$steps
  }
}

impStepByDday <- aggregate(steps ~ date, da_imputed, sum)
head(impStepByDday)

hist(impStepByDday$steps, main="Total No. of steps / day (imputed)", 
     xlab="Total #  of steps per day")
```

**Mean and median number of steps taken each day**

```{r echo=TRUE}
mean(impStepByDday$steps)
median(impStepByDday$steps)
mean(stepsByDay$total)
median(stepsByDay$total)
```

**Inspecting for differences in activity patterns between weekdays and weekends**


```{r echo=TRUE}
WeekDay <- function(date_val) {
    wd <- weekdays(as.Date(date_val, '%Y-%m-%d'))
    if  (!(wd == 'Saturday' || wd == 'Sunday')) {
        rtn <- 'Weekday'
    } else {
        rtn <- 'Weekend'
    }
    rtn
}
```

Apply the week_day function and add a new column to activity dataset
generating aggregated data frame

```{r echo=TRUE}
dr$day_type <- as.factor(sapply(dr$date, WeekDay))


stepsPerDayImpute <- aggregate(steps ~ interval+day_type, dr, mean)
```

Showing chart

```{r echo=TRUE}

chrt <- ggplot(stepsPerDayImpute, aes(interval, steps)) +
    geom_line(stat = "identity", aes(colour = day_type)) +
    theme_gray() +
    facet_grid(day_type ~ ., scales="fixed", space="fixed") +
    labs(x="Interval", y=expression("No of Steps")) +
    ggtitle("# of steps/Interval by daytype")

print(chrt)

```


